<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Add Experience • UnseenRealm</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Inter,system-ui,sans-serif}
body{
  background:#080011;color:#fff;min-height:100vh;
  display:flex;flex-direction:column;align-items:center;overflow-x:hidden;
}

/* Background glow */
body::before,body::after{
  content:"";position:fixed;inset:0;z-index:-2;
}
body::before{
  background:
    radial-gradient(circle at 20% 20%,#ff00f530,transparent 50%),
    radial-gradient(circle at 80% 80%,#00e1ff30,transparent 50%),
    #080011;
}
body::after{
  background:radial-gradient(circle,#ff00f560,transparent 60%);
  filter:blur(130px);opacity:.7;mix-blend-mode:screen;
  animation:g 9s infinite alternate;
}
@keyframes g {from{opacity:.5} to{opacity:.9}}

/* NAVBAR */
.nav{
  position:fixed;top:0;width:100%;padding:1rem 2rem;
  display:flex;justify-content:space-between;align-items:center;
  background:rgba(0,0,0,.35);backdrop-filter:blur(12px);z-index:50;
}
.logo{font-size:1.7rem;font-weight:800}
.logo span{color:#ff00f5}
#navLinks a{
  margin-left:1rem;text-decoration:none;color:#fff;position:relative;
}
#navLinks a::after{
  content:"";position:absolute;left:0;bottom:-3px;width:0;height:2px;
  background:#ff00f5;transition:.25s;
}
#navLinks a:hover::after{width:100%}

/* CARD */
.container{
  width:100%;max-width:450px;margin-top:7rem;
  background:rgba(255,255,255,.06);
  border-radius:20px;padding:2rem 2.2rem;
  border:1px solid rgba(255,255,255,.12);
  backdrop-filter:blur(16px);
  box-shadow:0 0 28px rgba(255,0,245,.25);
  animation:fade .5s ease;
}
@keyframes fade{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}

h1{
  font-size:2rem;font-weight:800;text-align:center;
  background:linear-gradient(90deg,#ff00f5,#00e1ff);
  -webkit-background-clip:text;color:transparent;margin-bottom:1rem;
}

.field{margin-bottom:1.1rem}
label{display:block;margin-bottom:.35rem;font-size:.9rem;color:#ccc}
input,select,textarea{
  width:100%;padding:.85rem 1rem;border-radius:12px;
  border:1px solid rgba(255,255,255,.18);
  background:rgba(255,255,255,.08);color:#fff;font-size:.9rem;
  outline:none;transition:.25s;
}
textarea{height:90px;resize:none}
input:focus,select:focus,textarea:focus{
  border-color:#ff00f5;box-shadow:0 0 15px #ff00f577;
}

.btn{
  width:100%;padding:.9rem;border-radius:12px;border:none;
  background:linear-gradient(90deg,#ff00f5,#00e1ff);
  color:#fff;font-weight:700;font-size:1rem;cursor:pointer;
  transition:.25s;margin-top:.7rem;
}
.btn:hover{transform:scale(1.03);box-shadow:0 0 20px #ff00f5}

.status{text-align:center;margin-top:1rem;color:#00e1ff;min-height:20px;font-size:.9rem}
</style>
</head>

<body>

<!-- ===================== FIREBASE INIT (CORRECT ORDER) ===================== -->

<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

<script>
const firebaseConfig={
  apiKey:"AIzaSyA7qrQeypEYFhKCvQjM-5PaMaYpTFJZ-mk",
  authDomain:"unseenrealm-b43d9.firebaseapp.com",
  projectId:"unseenrealm-b43d9",
  storageBucket:"unseenrealm-b43d9.appspot.com",
  messagingSenderId:"893669581410",
  appId:"1:893669581410:web:ebfdbdeacc27dced73673b"
};
firebase.initializeApp(firebaseConfig);

const auth=firebase.auth();
const db=firebase.firestore();
</script>

<!-- ======================== NAVBAR ======================== -->

<header class="nav">
  <div class="logo">Unseen<span>Realm</span></div>

  <nav id="navLinks"></nav>
</header>

<script>
// Build navbar dynamically after auth loads
auth.onAuthStateChanged(user => {
  const nav = document.getElementById("navLinks");

  if(user){
    nav.innerHTML = `
      <a href="index.html">Home</a>
      <a href="explore.html">Explore</a>
      <a href="add-experience.html">Add Experience</a>
      <a href="itinerary.html">Itinerary</a>
      <a href="profile.html">Profile</a>
      <a href="#" id="logoutBtn">Logout</a>
    `;

    document.getElementById("logoutBtn").onclick = async () => {
      await auth.signOut();
      location.href = "login.html";
    };

  } else {
    nav.innerHTML = `
      <a href="index.html">Home</a>
      <a href="explore.html">Explore</a>
      <a href="add-experience.html">Add Experience</a>
      <a href="itinerary.html">Itinerary</a>
      <a href="profile.html">Profile</a>
      <a href="login.html">Login</a>
      <a href="signup.html">Signup</a>
    `;
  }
});
</script>

<!-- ======================== FORM ======================== -->

<div class="container">
  <h1>Add New Experience</h1>

  <form id="addForm">

    <div class="field">
      <label>Title</label>
      <input type="text" id="exTitle" required>
    </div>

    <div class="field">
      <label>City</label>
      <input type="text" id="exCity" required>
    </div>

    <div class="field">
      <label>Description</label>
      <textarea id="exDesc" required></textarea>
    </div>

    <div class="field">
      <label>Interest Type</label>
      <select id="exInterest">
        <option value="nature">Nature</option>
        <option value="adventure">Adventure</option>
        <option value="food">Food</option>
        <option value="culture">Culture</option>
        <option value="nightlife">Nightlife</option>
      </select>
    </div>

    <div class="field">
      <label>Mood</label>
      <select id="exMood">
        <option value="chill">Chill</option>
        <option value="social">Social</option>
        <option value="adrenaline">Adrenaline</option>
        <option value="budget">Budget</option>
      </select>
    </div>

    <div class="field">
      <label>Rating (1–5)</label>
      <input type="number" id="exRating" min="1" max="5" required>
    </div>

    <div class="field">
      <label>Budget</label>
      <select id="exBudget">
        <option value="low">₹ Low</option>
        <option value="mid">₹₹ Medium</option>
        <option value="high">₹₹₹ High</option>
        <option value="free">Free</option>
      </select>
    </div>

    <div class="field">
      <label>Crowd</label>
      <select id="exCrowd">
        <option value="calm">Calm</option>
        <option value="medium">Medium</option>
        <option value="busy">Busy</option>
      </select>
    </div>

    <div class="field">
      <label>Latitude</label>
      <input type="number" step="0.000001" id="exLat" required>
    </div>

    <div class="field">
      <label>Longitude</label>
      <input type="number" step="0.000001" id="exLng" required>
    </div>

    <button class="btn" type="submit">Add Experience</button>
  </form>

  <div id="status" class="status"></div>
</div>

<!-- ======================== FIRESTORE SAVE SCRIPT ======================== -->

<script>
document.getElementById("addForm").addEventListener("submit", async(e)=>{
  e.preventDefault();

  const data={
    title:exTitle.value,
    city:exCity.value,
    description:exDesc.value,
    interest:exInterest.value,
    mood:exMood.value,
    rating:Number(exRating.value),
    budget:exBudget.value,
    crowd:exCrowd.value,
    mapY:Number(exLat.value),
    mapX:Number(exLng.value),
    timestamp:Date.now()
  };

  try{
    await db.collection("experiences").add(data);
    status.innerHTML="✔ Experience added successfully!";
    status.style.color="#00ffa6";
    addForm.reset();
  }
  catch(err){
    status.innerHTML=err.message;
    status.style.color="#ff6ec7";
  }
});
</script>

</body>
</html>
